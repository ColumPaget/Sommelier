OBJ=common.o config.o apps.o platforms.o command-line.o desktopfiles.o regedit.o download.o install.o uninstall.o
LIBUSEFUL=libUseful/libUseful.a
LIBS=@LIBS@
CFLAGS=@CFLAGS@ @DEFS@
prefix=@prefix@
exec_prefix=@exec_prefix@

all: $(OBJ) main.c $(LIBUSEFUL)
	gcc $(CFLAGS) -osommelier $(OBJ) $(LIBUSEFUL) $(LIBS) main.c 

$(LIBUSEFUL):
	@cd libUseful; $(MAKE)

common.o: common.h common.c
	gcc $(CFLAGS) -c common.c

config.o: config.h config.c
	gcc $(CFLAGS) -c config.c

apps.o: apps.h apps.c
	gcc $(CFLAGS) -c apps.c

platforms.o: platforms.h platforms.c
	gcc $(CFLAGS) -c platforms.c

command-line.o: command-line.h command-line.c
	gcc $(CFLAGS) -c command-line.c

desktopfiles.o: desktopfiles.h desktopfiles.c
	gcc $(CFLAGS) -c desktopfiles.c

download.o: download.h download.c
	gcc $(CFLAGS) -c download.c

install.o: install.h install.c
	gcc $(CFLAGS) -c install.c

uninstall.o: uninstall.h uninstall.c
	gcc $(CFLAGS) -c uninstall.c


regedit.o: regedit.h regedit.c
	gcc $(CFLAGS) -c regedit.c


clean:
	rm -f sommelier *.o libUseful/*.o libUseful/*.so libUseful/*.a

install:
	mkdir -p $(exec_prefix)/bin
	cp sommelier $(exec_prefix)/bin
